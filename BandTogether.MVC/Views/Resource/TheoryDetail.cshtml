@model BandTogether.Models.ResourceModels.TheoryResourceModels.TheoryDetail
@using BandTogether.Models.ResourceModels.TheoryResourceModels;
@using BandTogether.Models.ResourceModels;
@using Microsoft.AspNet.Identity;

@{
    ViewBag.Title = "TheoryDetail";
}
@if (Model.IsDownloadable)
{
    <div class="clearfix">
        @Html.ActionLink("Download Now", "Download", new { id = Model.FileId }, new { @class = "btn update-profile-btn float-right" })
    </div>
}
else
{
    if (User.Identity.GetUserId() == Model.TeacherId)
    {
        <div class="clearfix">
            @Html.ActionLink("Download Now", "Download", new { id = Model.FileId }, new { @class = "btn update-profile-btn float-right" })
        </div>
    }
    else
    {
        <div class="clearfix">
            <a class="btn not-downloadable float-right">Not Available</a>
        </div>
    }

}
<hr />
<div class="row">
    <div class="col-4">
        <h2>@Html.DisplayFor(model => model.Title)</h2>
        <p class="mb-0">Added: @Html.DisplayFor(model => model.DateCreated)</p>
        @if (Model.DateModified != null)
        {
            <p>Updated: @Html.DisplayFor(model => model.DateModified)</p>
        }
        <hr />
        <p class="font-weight-bold mb-0">
            Description:
        </p>
        <p>@Html.DisplayFor(model => model.Description)</p>
        <hr />
        <div class="dl-horizontal">
            <p>
                <span class="font-weight-bold">@Html.DisplayNameFor(model => model.Topic):</span> @Html.DisplayFor(model => model.Topic)
            </p>
            <p>
                <span class="font-weight-bold">@Html.DisplayNameFor(model => model.GradeLevel):</span> @Html.DisplayFor(model => model.GradeLevel)
            </p>
        </div>
        <hr />
        <h5>@Html.ActionLink(@Html.DisplayFor(modelItem => Model.TeacherName).ToHtmlString(), "Detail", "Teacher", new { id = Model.TeacherId }, null)</h5>
        @if (User.Identity.GetUserId() == Model.TeacherId)
        {
            Html.RenderPartial("TheoryEdit", new TheoryEdit(Model.TeacherId, Model.ResourceId, Model.Title, Model.Description, Model.IsDownloadable, Model.IsPublic, Model.Topic, Model.GradeLevel));
            Html.RenderPartial("DeleteResource", new ResourceDelete(Model.ResourceId, Model.TeacherId, Model.Title, Model.Description, Model.DateCreated));
        }
    </div>
    <div class="col-8">
        @{

            if (User.Identity.GetUserId() == Model.TeacherId)
            {

                if (Model.ContentType == "application/pdf" || Model.ContentType == "pdf")
                {

                    <iframe src="@Url.Action("File", "Resource", new { id = Model.FileId })#toolbar=0" type="@Model.ContentType" frameborder="0"></iframe>
                }
                else
                {
                    <div class="not-available text-center">
                        <p class="font-weight-bold">PDF is the only document type supported by preview at this time.  Update to PDF to be able to preview.</p>
                    </div>
                }
            }
            else
            {
                if (!Model.IsDownloadable)
                {
                    <div class="not-available text-center">
                        <p class="font-weight-bold">@Html.DisplayFor(model => model.TeacherName) is not allowing users to download this resource at this time. Please check back later or contact them directly.</p>
                    </div>
                }
                else if (Model.ContentType != "application/pdf" || Model.ContentType != "pdf")
                {
                    <div class="not-available text-center">
                        <p class="font-weight-bold">PDFs are the only document supported by preview at this time. Download the document to view.</p>
                    </div>
                }
                else
                {
                    <iframe src="@Url.Action("File", "Resource", new { id = Model.FileId })#toolbar=0" type="@Model.ContentType" frameborder="0"></iframe>
                }
            }
        }
    </div>
</div>

@section Scripts{

}
